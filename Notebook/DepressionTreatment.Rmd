---
title: "Comparison of VR Based and Traditional Treatments of Depression on Males and Females Aged 18-80"
output: html_notebook
---

```{r Libraries}
# Load Packages
library(ggplot2)
library(tidyverse)
library(conflicted)
library(dplyr)
library(hmisc)
#Preference dplyr for conflicts
conflicts_prefer(dplyr::filter)
```

```{r}
#Define Dataset
depression_data <- read.csv("C:/Users/Ruth/Desktop/Ca1_RuthC/RC_Data_CA1/Data/participants_data_final.csv")
```

```{r}
#Pre Treatment Histogram
ggplot(depression_data, aes(x = Pre_Treatment_Score)) +
  geom_histogram(binwidth = 5, fill = "blue", color = "white") +
  labs(title = "Distribution of Pre-Treatment Scores", x = "Pre-Treatment Score", y = "Frequency") +
  theme_minimal()
```

```{r}
#Post Treatment Histogram
ggplot(depression_data, aes(x = Post_Treatment_Score)) +
  geom_histogram(binwidth = 5, fill = "red", color = "white") +
  labs(title = "Distribution of Post-Treatment Scores", x = "Post-Treatment Score", y = "Frequency") +
  theme_minimal()
```

```{r Comparison of Pre and Post Treatment Scores by Gender and Treatment Type}
library(tidyverse)

# Change to Long Format
long_data <- depression_data %>%
  pivot_longer(
    cols = c(Pre_Treatment_Score, Post_Treatment_Score),
    names_to = "Score_Type",    # New column indicating "Pre" or "Post"
    values_to = "Score"         # Column for scores
  )

#BoxPlot
ggplot(long_data, aes(x = interaction(Gender, Score_Type), y = Score, fill = Group)) +
  geom_boxplot(alpha = 0.5) +
  labs(
    title = "Pre and Post Treatment Scores by Gender and Group",
    x = "Gender and Score Type",
    y = "Score",
    fill = "Group"
  ) +
  theme_minimal() +
  scale_x_discrete(labels = c("Male.Pre" = "Male (Pre)", "Male.Post" = "Male (Post)",
                              "Female.Pre" = "Female (Pre)", "Female.Post" = "Female (Post)"))+
  scale_fill_manual(values = c("dodgerblue1", "orange"))



```

```{r Average Change in Score by Gender and Treatment Group}


ggplot(depression_data, aes(x = interaction(Gender, Group), y = Change_in_Score, fill = Group)) +
  stat_summary(fun = mean, geom = "bar", position = position_dodge(), width = 0.7) +
  stat_summary(fun.data = mean_cl_normal, geom = "errorbar", position = position_dodge(0.7), width = 0.2) +
  labs(
    title = "Average Change in Score by Gender and Treatment Group",
    x = "Gender and Treatment Group",
    y = "Average Change in Score",
    fill = "Treatment Group"
  ) +
  theme_minimal() +
  scale_x_discrete(labels = c("Male.Control" = "Male (Control)", "Male.Experimental" = "Male (Experimental)",
                              "Female.Control" = "Female (Control)", "Female.Experimental" = "Female (Experimental)"))

ggsave("change_in_score_by_gender_and_group.png", width = 10, height = 6)

```
