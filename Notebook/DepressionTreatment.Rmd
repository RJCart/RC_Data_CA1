---
title: "Comparison of VR Based and Traditional Treatments of Depression on Males and Females Aged 18-80"
output: html_notebook
---

**Abstract:**

The Aim of this project is to determine whether, in treatment of depression in Males and Females aged 18-40, a VR-based method of treatment is more effective than a traditional CBT method of treatment.

To assess depression severity, the author of the Dataset has used self reporting to gather severity of depression in 200 patients. The patients were psychotherapy patients, male(95) and female(105) and fell between the ages of 18 to 40 years old. The patients were randomly assigned to participate in the traditional CBT method (Control group) or the VR-Based method (experimental.) The patients then used the Zung Self-Rating Depression Scale

**Introduction**

The immersive nature of VR could be useful in the non-pharmacutical treatment of depression in men and women. In this study we will compare the results from the data gathered to determine whether the data itself is useful, and whether it is true that an experimental VR treatment for depression is as effective or perhaps more effective than a traditional Cognitive Behavioural method of treatment.

If the data shows that participants who suffer with symptoms of depression experience more relief through VR based therapy, then it could be said that this is an effective method of treatment for these symptoms.

**Hypothesis**:

In men and women aged 10-40 who suffer with symptoms of depression, a VR based method of treatment is more effective than traditional method in relieving these symptoms of depression.

**Method**

There were 100 participants in the survey, all of whom were between the age of 18 and 40. There were 95 males and 105 female participants. The participants were divided to two equal groups, one of which used Cognitive Behavioural Therapy (The Control group) and the other which used VR based therapy (Experimental Group). The participants spent 50 minutes per week for the duration of 12 weeks with a therapist. The participants were asked to self report at the beginning and end of the study. The Zung Depression Scale was used. It is a 20-item sale which asks to report from 1 to 4 with 1 meaning a little of the time and 4 meaning most of the time. The scores ranged from 20 to80.

In this document, we will use statistical analysis to determine whether a difference can be observed between the treatment methods in men and in women.

To determine whether there is a significant change in score between the two groups, also between men and women.

**Results**

```{r Libraries}
# Load Packages
library(ggplot2)
library(tidyverse)
library(conflicted)
library(dplyr)
library(hmisc)
#Preference dplyr for conflicts
conflicts_prefer(dplyr::filter)
```

```{r Import_Data_Set}
#Define Dataset
depression_data <- read.csv("C:/Users/Ruth/Desktop/Ca1_RuthC/RC_Data_CA1/Data/participants_data_final.csv")
```

```{r Summary_Data}


# Calculate summary statistics
summary_data <- depression_data %>%
  pivot_longer(
    cols = c(Pre_Treatment_Score, Post_Treatment_Score),
    names_to = "Treatment_Phase",    # New column: "Pre_Treatment" or "Post_Treatment"
    values_to = "Score"              # Column for scores
  ) %>%
  group_by(Group, Treatment_Phase) %>%
  summarise(
    Mean_Score = mean(Score, na.rm = TRUE),
    SE = sd(Score, na.rm = TRUE) / sqrt(n()),        # SE Standard Error
    Lower_CI = Mean_Score - qt(0.975, df = n() - 1) * SE,  # Lower 95% CI
    Upper_CI = Mean_Score + qt(0.975, df = n() - 1) * SE,   # Upper 95% CI
    .groups = "drop"
  )

```

```{r Pre_Treatment_Severity}

depression_data <- depression_data %>%
  mutate(Severity = case_when(
    Pre_Treatment_Score <= 44 ~ "Normal",
    Pre_Treatment_Score <= 59 ~ "Mild",
    Pre_Treatment_Score <= 69 ~ "Moderate",
    Pre_Treatment_Score > 70 ~ "Severe",
    ))

#Create Table
severity_table <- depression_data %>%
  count(Severity) %>%
  arrange(desc(n))
severity_table <- severity_table %>%
  mutate(Percentage = n / sum(n) * 100)

#Group By Treatment
severity_by_treatment <- depression_data %>%
  group_by(Group, Severity) %>%
  summarise(Frequency = n(), .groups = "drop") %>%
  mutate(Percentage = Frequency / sum(Frequency) * 100)
print(severity_by_treatment)

#Plot Data
ggplot(severity_by_treatment, aes(x = Severity, y = Frequency, fill = Group)) +
  geom_bar(stat = "identity", position = "dodge") +
  scale_fill_manual(
    values = c("Control (CBT)" = "dodgerblue1", "Experimental (VR)" ="orange")) +
  labs(
    title = "Pre-Treatment Depression Severity",
    x = "Severity Level",
    y = "Frequency",
    fill = "Treatment Type"
  ) +
  theme_minimal()
```

```{r Post_Treatment_Severity}

depression_data <- depression_data %>%
  mutate(Severity = case_when(
    Post_Treatment_Score <= 44 ~ "Normal",
    Post_Treatment_Score <= 59 ~ "Mild",
    Post_Treatment_Score <= 69 ~ "Moderate",
    Post_Treatment_Score > 70 ~ "Severe",
    ))

#Create Table
severity_table <- depression_data %>%
  count(Severity) %>%
  arrange(desc(n))
severity_table <- severity_table %>%
  mutate(Percentage = n / sum(n) * 100)

#Group By Treatment
severity_by_treatment <- depression_data %>%
  group_by(Group, Severity) %>%
  summarise(Frequency = n(), .groups = "drop") %>%
  mutate(Percentage = Frequency / sum(Frequency) * 100)
print(severity_by_treatment)

#Plot Data
ggplot(severity_by_treatment, aes(x = Severity, y = Frequency, fill = Group)) +
  geom_bar(stat = "identity", position = "dodge") +
  scale_fill_manual(
    values = c("Control (CBT)" = "dodgerblue1", "Experimental (VR)" ="orange")) +
  labs(
    title = "Post-Treatment Depression Severity",
    x = "Severity Level",
    y = "Frequency",
    fill = "Treatment Type"
  ) +
  theme_minimal()


```

```{r Comparing_Pre_And_Post_Treatment_Scores_By_Gender_And_Treatment_Type}


# Change to Long Format
long_data <- depression_data %>%
  pivot_longer(
    cols = c(Pre_Treatment_Score, Post_Treatment_Score),
    names_to = "Score_Type",    # New column indicating "Pre" or "Post"
    values_to = "Score"         # Column for scores
  )

#BoxPlot
ggplot(long_data, aes(x = interaction(Gender, Score_Type), y = Score, fill = Group)) +
  geom_boxplot(alpha = 0.5) +
  labs(
    title = "Pre and Post Treatment Scores by Gender and Group",
    x = "Gender and Score Type",
    y = "Score",
    fill = "Group"
  ) +
  theme_minimal() +
  scale_x_discrete(labels = c("Male.Pre" = "Male (Pre)", "Male.Post" = "Male (Post)",
                              "Female.Pre" = "Female (Pre)", "Female.Post" = "Female (Post)"))+
  scale_fill_manual(values = c("dodgerblue1", "orange"))


```

```{r Average_Change_In_Score_By_Gender_And_Treatment_Group}


ggplot(depression_data, aes(x = interaction(Gender, Group), y = Change_in_Score, fill = Group)) +
  stat_summary(fun = mean, geom = "bar", position = position_dodge(), width = 0.7) +
  stat_summary(fun.data = mean_cl_normal, geom = "errorbar", position = position_dodge(0.7), width = 0.2) +
  labs(
    title = "Average Change in Score by Gender and Treatment Group",
    x = "Gender and Treatment Group",
    y = "Average Change in Score",
    fill = "Treatment Group"
  ) +
  theme_minimal() +
  scale_x_discrete(labels = c("Male.Control" = "Male (Control)", "Male.Experimental" = "Male (Experimental)",
                              "Female.Control" = "Female (Control)", "Female.Experimental" = "Female (Experimental)"))+
  scale_fill_manual(values = c("dodgerblue1", "orange"))



```

```{r Relationship_Between_Initial_Scores_And_Change_After_Treatment}
ggplot(depression_data, aes(x = Pre_Treatment_Score, y = Post_Treatment_Score, color = Group)) +
  geom_point(size = 3, alpha = 0.7) +
  geom_smooth(method = "lm", se = FALSE, size = 1) +
  labs(
    title = "Relationship Between Initial Scores and Change After Treatment",
    x = "Initial Depression Score",
    y = "Post Treatment Score",
    color = "Treatment Group"
  ) +
  theme_minimal() +
  facet_wrap(~ Group) +
  scale_color_manual(values = c("dodgerblue1", "orange"))

```

```{r Mean_Depression_Scores_Pre_VS_Post_Treatment}
#Pre Treatment Histogram
ggplot(summary_data, aes(x = Treatment_Phase, y = Mean_Score, color = Group, group = Group)) +
  geom_point(size = 4, position = position_dodge(0.2)) +  # Add points for means
  geom_errorbar(
    aes(ymin = Lower_CI, ymax = Upper_CI),
    width = 0.2, size = 1, position = position_dodge(0.2)
  ) +
  geom_line(position = position_dodge(0.2)) +  # Connect points with lines
  labs(
    title = "95% Confidence Intervals for Depression Scores",
    x = "Treatment Phase",
    y = "Mean Depression Score",
    color = "Treatment Group"
  ) +
  theme_minimal() +
  scale_color_manual(values = c("dodgerblue1", "orange")) +
  scale_x_discrete(labels = c("Pre_Treatment_Score" = "Pre-Treatment", "Post_Treatment_Score" = "Post-Treatment"))
```
